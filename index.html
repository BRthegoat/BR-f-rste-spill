<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <title>Flappy Bird Clone</title>
  <style>
    body {
      margin: 0;
      background: #70c5ce;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: Arial, sans-serif;
    }

    canvas {
      background: linear-gradient(#70c5ce, #ffffff);
      border: 3px solid #000;
    }

    #info {
      position: absolute;
      top: 20px;
      color: #000;
      font-size: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div id="info">Klikk eller SPACE for å fly</div>
<canvas id="game" width="400" height="600"></canvas>

<script>
  const canvas = document.getElementById("game");
  const ctx = canvas.getContext("2d");

  let bird = {
    x: 80,
    y: 250,
    radius: 15,
    velocity: 0,
    gravity: 0.5,
    jump: -8
  };

  let pipes = [];
  let frame = 0;
  let score = 0;
  let gameOver = false;

  function resetGame() {
    bird.y = 250;
    bird.velocity = 0;
    pipes = [];
    score = 0;
    frame = 0;
    gameOver = false;
  }

  function drawBird() {
    ctx.beginPath();
    ctx.arc(bird.x, bird.y, bird.radius, 0, Math.PI * 2);
    ctx.fillStyle = "yellow";
    ctx.fill();
    ctx.stroke();
  }

  function drawPipes() {
    pipes.forEach(p => {
      ctx.fillStyle = "green";
      ctx.fillRect(p.x, 0, p.width, p.top);
      ctx.fillRect(p.x, canvas.height - p.bottom, p.width, p.bottom);
    });
  }

  function updatePipes() {
    if (frame % 90 === 0) {
      let gap = 140;
      let top = Math.random() * 200 + 50;
      pipes.push({
        x: canvas.width,
        width: 50,
        top: top,
        bottom: canvas.height - top - gap
      });
    }

    pipes.forEach(p => {
      p.x -= 2;

      if (
        bird.x + bird.radius > p.x &&
        bird.x - bird.radius < p.x + p.width &&
        (bird.y - bird.radius < p.top ||
         bird.y + bird.radius > canvas.height - p.bottom)
      ) {
        gameOver = true;
      }

      if (p.x + p.width === bird.x) {
        score++;
      }
    });

    pipes = pipes.filter(p => p.x + p.width > 0);
  }

  function drawScore() {
    ctx.fillStyle = "#000";
    ctx.font = "30px Arial";
    ctx.fillText(score, canvas.width / 2 - 10, 50);
  }

  function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (!gameOver) {
      bird.velocity += bird.gravity;
      bird.y += bird.velocity;

      if (bird.y + bird.radius > canvas.height || bird.y - bird.radius < 0) {
        gameOver = true;
      }

      updatePipes();
      drawPipes();
      drawBird();
      drawScore();

      frame++;
      requestAnimationFrame(gameLoop);
    } else {
      ctx.fillStyle = "red";
      ctx.font = "40px Arial";
      ctx.fillText("GAME OVER", 80, 300);
      ctx.font = "20px Arial";
      ctx.fillText("Klikk for å starte på nytt", 90, 340);
    }
  }

  function jump() {
    if (gameOver) {
      resetGame();
      gameLoop();
    } else {
      bird.velocity = bird.jump;
    }
  }

  document.addEventListener("keydown", e => {
    if (e.code === "Space") jump();
  });

  canvas.addEventListener("click", jump);

  gameLoop();
</script>

</body>
</html>
